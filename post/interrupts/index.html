<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Interrupts - COMP2121 Musings</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content=z5206677><meta name=description content="What is an Interrupt?"><meta name=keywords content=Hugo,theme,even><meta name=generator content="Hugo 0.58.2 with theme even"><link rel=canonical href=../../post/interrupts/><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../manifest.json><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><link href=../../dist/even.c2a46f00.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=../../css/typedjs.shortcode.css><meta property=og:title content=Interrupts><meta property=og:description content="What is an Interrupt?"><meta property=og:type content=article><meta property=og:url content=/post/interrupts/><meta property=article:published_time content=2020-03-11T13:58:34+11:00><meta property=article:modified_time content=2020-03-11T13:58:34+11:00><meta itemprop=name content=Interrupts><meta itemprop=description content="What is an Interrupt?"><meta itemprop=datePublished content=2020-03-11T13:58:34&#43;11:00><meta itemprop=dateModified content=2020-03-11T13:58:34&#43;11:00><meta itemprop=wordCount content=516><meta itemprop=keywords content><meta name=twitter:card content=summary><meta name=twitter:title content=Interrupts><meta name=twitter:description content="What is an Interrupt?"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=../../ class=logo>COMP2121 Musings</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=../../><li class=mobile-menu-item>Home</li></a><a href=https://github.com/featherbear/UNSW-COMP2121><li class=mobile-menu-item>GitHub</li></a><a href=../../categories/><li class=mobile-menu-item>Categories</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=../../ class=logo>COMP2121 Musings</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=../../>Home</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/featherbear/UNSW-COMP2121>GitHub</a></li><li class=menu-item><a class=menu-item-link href=../../categories/>Categories</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Interrupts</h1><div class=post-meta><span class=post-time>2020-03-11</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#what-is-an-interrupt>What is an Interrupt?</a></li><li><a href=#assigning-functions-to-interrupts>Assigning functions to interrupts</a><ul><li><a href=#interrupt-vector-table-ivt>Interrupt Vector Table (IVT)</a></li><li><a href=#interrupt-service-routines-isr>Interrupt Service Routines (ISR)</a></li></ul></li><li><a href=#cpu-interaction>CPU Interaction</a><ul><li><a href=#polling>Polling</a></li><li><a href=#interrupt>Interrupt</a></li></ul></li><li><a href=#interrupt-systems>Interrupt Systems</a></li><li><a href=#priority-resolution>Priority Resolution</a><ul><li><a href=#daisy-chain-priority-resolution>Daisy Chain Priority Resolution</a></li></ul></li><li><a href=#separate-irq-lines>Separate IRQ Lines</a></li><li><a href=#hierarchical-prioritisation>Hierarchical Prioritisation</a></li><li><a href=#non-maskable-interrupts>Non-maskable Interrupts</a></li><li><a href=#performing-the-interrupt>Performing the Interrupt</a><ul><li><a href=#avr>AVR</a></li></ul></li><li><a href=#interrupt-vectors>Interrupt Vectors</a></li><li><a href=#inside-an-interrupt>Inside an Interrupt</a></li></ul></nav></div></div><div class=post-content><h1 id=what-is-an-interrupt>What is an Interrupt?</h1><p>An interrupt is a signal which causes the microprocessor to switch tasks.<br>It can be considered as a function</p><h1 id=assigning-functions-to-interrupts>Assigning functions to interrupts</h1><h2 id=interrupt-vector-table-ivt>Interrupt Vector Table (IVT)</h2><p>The Interrupt Vector Table holds the map of which interrupts call which Interrupt Service Routine</p><h2 id=interrupt-service-routines-isr>Interrupt Service Routines (ISR)</h2><p>The ISR is the function that is executed when an interrupt is executed.<br>To return from these routines, we use the <code>reti</code> instruction, compared to the usual <code>ret</code>.</p><h1 id=cpu-interaction>CPU Interaction</h1><h2 id=polling>Polling</h2><ul><li>Software queries the I/O device</li><li>No extra hardware needed</li><li>Not efficient</li></ul><h2 id=interrupt>Interrupt</h2><ul><li>I/O devices generate signals to request services from CPU</li><li>Need extra hardware to implement</li><li>Efficient</li></ul><h1 id=interrupt-systems>Interrupt Systems</h1><p>Interrupt systems implement interrupt services, performing the three tasks</p><ul><li>Recognise interrupt events</li><li>Respond to the interrupt</li><li>Resume the previous task</li></ul><hr><p>The CPU polls the status registers of all devices.<br>When it has found an interrupt flag, it will perform a selecton algorithm to find the corresponding service routine</p><h1 id=priority-resolution>Priority Resolution</h1><p>When multiple interrupts occur at the same time, which one is done first?</p><h2 id=daisy-chain-priority-resolution>Daisy Chain Priority Resolution</h2><p>When the CPU emits the INTA (INTerrupt Acknowledge) signal, the first device which receives it does not pass the INTA signal to the other devices until later. This device puts its vector onto the data bus and finishes it operation before passing the INTA signal.</p><h1 id=separate-irq-lines>Separate IRQ Lines</h1><p>Each Interrupt Request line is assigned a fixed priority.</p><p>IRQ0 &gt; IRQ1 &gt; IRQ2 &gt; etc</p><h1 id=hierarchical-prioritisation>Hierarchical Prioritisation</h1><p>Higher priority interrupts are allowed, whilst lower ones are masked (dismissed)</p><h1 id=non-maskable-interrupts>Non-maskable Interrupts</h1><p>Cannot disable these interrupts.<br><em>Used for important events such as power failures.</em></p><h1 id=performing-the-interrupt>Performing the Interrupt</h1><p>To transfer execution control to the Interrupt Service Routine (ISR).</p><p>It takes time from when the IRQ is generated, to the time the ISR is executed.<br>This time delay is known as the <code>interrupt latency</code>.<br>It will take at least 5 clock cycles.<br>Two for saving the PC, and three for jumping to the ISR.</p><ul><li>Hardware saves the return address (next intstruction to perform after the ISR is finished)</li><li><p>Hardware saves registers</p></li><li><p>Non-nested ISRs will dismiss any new interrupts</p></li><li><p>Nested ISRs will allow new interrupts</p></li></ul><h2 id=avr>AVR</h2><p>AVR does not have a software interrupt, so we need to virtualise an external interrupt to trigger it.<br><em>(PORTA into PINA?)</em></p><p>To enable an interrupt, the Global Interrupt Enable bit needs to be set.<br>This is the <code>I</code> bit in the status bit, and can be enabled with <code>sei</code>.<br>To turn off, we can use <code>cli</code>.</p><p>In AVR, when an interrupt is finished, the CPU will interrupt at least one more instruction (where the PC is), before any other interrupt is served.</p><h1 id=interrupt-vectors>Interrupt Vectors</h1><p>Each interrupt is 4-bytes (2 words) longo, conntaining an instruction to be executed when the interrupt has been accepted.<br>The lower the memory address of the vectory, the higher its priority.</p><h1 id=inside-an-interrupt>Inside an Interrupt</h1><p>When an interrupt occurs, the Global Interrupt Enable bit is often cleared - disabling other interrupts from happening.<br>For the case of nested interrupts, this GEI bit is kept high.</p><p>When the <code>reti</code> instruction is executed the GEI bit is restored</p></div><footer class=post-footer><nav class=post-nav><a class=prev href=../../post/io-addressing/><i class="iconfont icon-left"></i><span class="prev-text nav-default">I/O Addressing</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=../../post/watchdog-timer/><span class="next-text nav-default">Watchdog Timer</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:z5206677@student.unsw.edu.au class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/andrewjinmengwong/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/featherbear class="iconfont icon-github" title=github></a><a href=https://www.instagram.com/_andrewjwong/ class="iconfont icon-instagram" title=instagram></a><a href=../../index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Andrew Wong (z5206677)</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=../../dist/even.26188efa.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-107434487-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=../../js/typed.js@2.0.9></script><script src=../../js/typedjs.shortcode.js></script></body></html>