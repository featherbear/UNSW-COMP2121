<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Serial Devices - COMP2121 Musings</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content=z5206677><meta name=description content="Parallel IO requires a wire for each bit, and may have synchronisation issues if not all of the bits are written nor read at the same time."><meta name=keywords content=Hugo,theme,even><meta name=generator content="Hugo 0.58.2 with theme even"><link rel=canonical href=../../post/serial-devices/><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../manifest.json><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><link href=../../dist/even.c2a46f00.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=../../css/typedjs.shortcode.css><meta property=og:title content="Serial Devices"><meta property=og:description content="Parallel IO requires a wire for each bit, and may have synchronisation issues if not all of the bits are written nor read at the same time."><meta property=og:type content=article><meta property=og:url content=/post/serial-devices/><meta property=article:published_time content=2020-04-28T23:44:15+10:00><meta property=article:modified_time content=2020-04-28T23:44:15+10:00><meta itemprop=name content="Serial Devices"><meta itemprop=description content="Parallel IO requires a wire for each bit, and may have synchronisation issues if not all of the bits are written nor read at the same time."><meta itemprop=datePublished content=2020-04-28T23:44:15&#43;10:00><meta itemprop=dateModified content=2020-04-28T23:44:15&#43;10:00><meta itemprop=wordCount content=791><meta itemprop=keywords content><meta name=twitter:card content=summary><meta name=twitter:title content="Serial Devices"><meta name=twitter:description content="Parallel IO requires a wire for each bit, and may have synchronisation issues if not all of the bits are written nor read at the same time."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=../../ class=logo>COMP2121 Musings</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=../../><li class=mobile-menu-item>Home</li></a><a href=https://github.com/featherbear/UNSW-COMP2121><li class=mobile-menu-item>GitHub</li></a><a href=../../categories/><li class=mobile-menu-item>Categories</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=../../ class=logo>COMP2121 Musings</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=../../>Home</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/featherbear/UNSW-COMP2121>GitHub</a></li><li class=menu-item><a class=menu-item-link href=../../categories/>Categories</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Serial Devices</h1><div class=post-meta><span class=post-time>2020-04-28</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#synchronous-serial>Synchronous Serial</a></li><li><a href=#asynchronous-serial>Asynchronous Serial</a></li><li><a href=#universal-asynchronous-receiver-and-transmitter-uart>Universal Asynchronous Receiver and Transmitter (UART)</a><ul><li><a href=#baud-rate>Baud Rate</a></li><li><a href=#communication-systems>Communication Systems</a><ul><li><a href=#simplex>Simplex</a></li><li><a href=#half-duplex>Half Duplex</a></li><li><a href=#full-duplex>Full Duplex</a></li></ul></li><li><a href=#communication-devices>Communication Devices</a><ul><li><a href=#modems>Modems</a></li></ul></li><li><a href=#serial-standards>Serial Standards</a></li></ul></li><li><a href=#avr-usart>AVR USART</a><ul><li><a href=#interrupts>Interrupts</a></li><li><a href=#components>Components</a></li><li><a href=#frame-formats>Frame Formats</a></li><li><a href=#parity-bit>Parity Bit</a></li><li><a href=#avr-control-registers>AVR Control Registers</a></li><li><a href=#initialising-usart-on-avr>Initialising USART on AVR</a></li><li><a href=#transmitting>Transmitting</a><ul><li><a href=#polling>Polling</a></li><li><a href=#interrupts-1>Interrupts</a></li></ul></li><li><a href=#receiving>Receiving</a><ul><li><a href=#polling-1>Polling</a></li></ul></li><li><a href=#errors>Errors</a><ul><li><a href=#error-detection>Error Detection</a></li><li><a href=#error-recovery-during-asynchronous-transmission>Error Recovery (During asynchronous transmission)</a></li></ul></li></ul></li></ul></nav></div></div><div class=post-content><p>Parallel IO requires a wire for each bit, and may have synchronisation issues if not all of the bits are written nor read at the same time.</p><p><img src="Screenshot from 2020-04-28 23-46-17.png" alt></p><p>Data is loaded onto the Parallel In / Serial Out (PISO) register, and the T_clock (transmit) shifts the data bits out from the register to the receiver.</p><p>On the receiving end, the R_clock (receive clock) shifts the data bits out from the Serial In / Parallel Out (SIPO) register, and into the received data buffer where it can be access in parallel</p><h1 id=synchronous-serial>Synchronous Serial</h1><ul><li>Transmitter and receiver clocks are synchronised</li><li>Requires extra hardware for clock synchronisation</li><li>Allows faster data transfer rates</li></ul><h1 id=asynchronous-serial>Asynchronous Serial</h1><p>Triggers.</p><h1 id=universal-asynchronous-receiver-and-transmitter-uart>Universal Asynchronous Receiver and Transmitter (UART)</h1><p><img src="Screenshot from 2020-04-28 23-50-35.png" alt></p><p>The UART circuit is both a transmitter and receiver in one.</p><p>The least significant bits are transmitted before the most significant bits.</p><p><img src="Screenshot from 2020-04-28 23-51-35.png" alt></p><p>Encoded data is encapsulated with a start and stop bit.<br>When the receiver detects the start bit (space level for one bit-time), it begins the read clock.<br>When the receiver detects the stop bit, it stops the read clock.</p><h2 id=baud-rate>Baud Rate</h2><p>Rate of transfer of <strong><em>bits per second</em></strong></p><p>Commonly 110, 150, 300, 600, 900, 1200, 2400, 4800, 9600, 14400, 19200, 38400, 57600, 115200, 230400, 460800, 921600.</p><h2 id=communication-systems>Communication Systems</h2><h3 id=simplex>Simplex</h3><p>Data is sent in one direction only.</p><p>Two wires needed</p><h3 id=half-duplex>Half Duplex</h3><p>Data can be sent in both ways, but in only one direction at a time.<br>Requires a handshaking system + hardware to share the same wire.</p><h3 id=full-duplex>Full Duplex</h3><p>Data can be sent in both ways, as each device has their own transmit wire (receive on the other end)
Three wires are needed (but often called 4 wire systems as we often keep wires in pairs)</p><h2 id=communication-devices>Communication Devices</h2><ul><li>DCE - Data Communications Equipment - Provides a path for communication - i.e. Modem</li><li>DTE - Data Termination Equipment - Connects to a communication line - i.e Computer</li></ul><h3 id=modems>Modems</h3><blockquote><p>MODulator / DEModulator</p></blockquote><ul><li>Modulator - Converts logical levels into tones to be sent over wire.<br></li><li>Demodulator - Converts tones into logical levels</li></ul><h2 id=serial-standards>Serial Standards</h2><p>Standards are important to allow for the communication between devices of different manufacturers.</p><p>For example RS-232-C, RS-422, RS-423 and RS-485.</p><p>Standards often involve the negotiation of</p><ul><li>Handshaking signals</li><li>Direction of data flow</li><li>Types of communication devices</li><li>Connectors and interface mechanical consideration</li><li>Electrical signal levels</li></ul><p>RS-232-C is often used, however a standard like RS-422, RS-423 or RS-485 should be used for signals that need to be transmitted more than 15m, or faster than 20 Kbps.</p><p>Standards also have standardised pin connections - ie RS-232-C has DE9 and DB25 pins</p><p><img src="Screenshot from 2020-04-29 00-04-16.png" alt></p><hr><h1 id=avr-usart>AVR USART</h1><p>In AVR, there are two USART (Universal Synchronous/Asynchronous Receiver/Transmitter) controllers.<br>Each can be configured for either synchronous or asynchronous communication.</p><p>They support many different serial protocols, and also support parity and error detection.</p><h2 id=interrupts>Interrupts</h2><p>To communicate with the host controller, they offer three interrupts:</p><ul><li>RX Complete</li><li>TX Complete</li><li>TX Data Register Error</li></ul><h2 id=components>Components</h2><ul><li>Clock Generator - Baud rate generator, slave clock input logic</li><li>Transmitter - Single write buffer, serial shift register, parity generator, control logic</li><li>Receiver - Receive buffer (UDR), serial shift register, parity checker, control logic, recovery unit (for async communication)</li></ul><h2 id=frame-formats>Frame Formats</h2><p>Specification of how many / value of start bits, data bits, parity bits, parity type and stop bits</p><h2 id=parity-bit>Parity Bit</h2><p>Used to roughly check whether the received data has been corrupted during transmission</p><h2 id=avr-control-registers>AVR Control Registers</h2><ul><li><code>UCSRA</code><ul><li>Status flags</li><li>Transmission speed</li><li>Processor usage</li></ul></li><li><code>UCSRB</code><ul><li>Enabling interrupt, transmission operations</li><li>Frame formats</li><li>Bit extension</li></ul></li><li><code>UCSRC</code><ul><li>Operation configuration</li></ul></li></ul><h2 id=initialising-usart-on-avr>Initialising USART on AVR</h2><ul><li>Set the baud rate</li><li>Set the frame rate</li><li>Enable the transmitter (<code>TXEN</code> bit in <code>UCSRB</code>) / receiver (<code>RXEN</code> bit in <code>UCSRB</code>) / both</li><li>[Optional] Enable the global interrupt flag (<code>sei</code>)</li></ul><h2 id=transmitting>Transmitting</h2><h3 id=polling>Polling</h3><ul><li>Wait for <code>UDRE</code> in <code>UCSR1A</code> to be set (with <code>lds</code> -&gt; <code>sbrs</code> -&gt; <code>rjmp</code>)</li><li>Load data into <code>UDR1</code> (with <code>sts</code>)</li></ul><h3 id=interrupts-1>Interrupts</h3><p>Wait for USART Data Register Empty (<code>UDRE</code>) or Transfer Complete (<code>TXC</code>) interrupt, then load next byte.</p><h2 id=receiving>Receiving</h2><h3 id=polling-1>Polling</h3><ul><li>Wait for <code>RXC1</code> in <code>UCSR1A</code> to be set (with <code>lds</code> -&gt; <code>sbrs</code> -&gt; <code>rjmp</code>)</li><li>Load data from <code>UDR1</code> (with <code>lds</code>)</li></ul><h2 id=errors>Errors</h2><p>Main from of errors come from out-of-sync data, and from signal noise.</p><h3 id=error-detection>Error Detection</h3><ul><li>Checking for Frame error - Check if first stop bit is correctly received</li><li>Checking for Parity error - Check if the number 1&rsquo;s match the parity bit</li><li>Checking for Data Overrun error - Check if data has not yet been read yet</li></ul><h3 id=error-recovery-during-asynchronous-transmission>Error Recovery (During asynchronous transmission)</h3><p>In the AVR board, the recovery unit samples and low-passes each incoming bit, improving the noise immunity of bits during reception.<br>It will also try to synchronise its internal clock with the incoming asynchronous frames.</p><blockquote><p>i.e. Check the same bit multiple times (ie 3 times) to ensure the read level is correct; use the majority</p></blockquote></div><footer class=post-footer><nav class=post-nav><a class=prev href=../../post/adc-and-dac/><i class="iconfont icon-left"></i><span class="prev-text nav-default">ADCs and DACs</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=../../post/final-exam/><span class="next-text nav-default">Final Exam</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:z5206677@student.unsw.edu.au class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/andrewjinmengwong/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/featherbear class="iconfont icon-github" title=github></a><a href=https://www.instagram.com/_andrewjwong/ class="iconfont icon-instagram" title=instagram></a><a href=../../index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Andrew Wong (z5206677)</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=../../dist/even.26188efa.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-107434487-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=../../js/typed.js@2.0.9></script><script src=../../js/typedjs.shortcode.js></script></body></html>